--- atftp-0.7-orig/tftpd.c	2004-02-26 19:05:26.000000000 -0700
+++ atftp-0.7/tftpd.c	2008-02-14 12:46:07.000000000 -0700
@@ -224,8 +224,13 @@
           /* daemonize here */
           if (!tftpd_daemon_no_fork)
           {
+#ifndef __BLACKFIN__
                if (daemon(0, 0) == -1)
                     exit(2);
+#else
+		logger(LOG_ERR,"atftpd: daemon not supported on blackfin");
+		exit(2);
+#endif
           }
 
           /* find the port */
--- atftp-0.7-orig/configure	2004-03-15 18:53:07.000000000 -0700
+++ atftp-0.7/configure	2008-02-14 12:46:49.000000000 -0700
@@ -3221,7 +3221,7 @@
 
 
 
-CFLAGS="-g -Wall -D_REENTRANT"
+CFLAGS="-g -Wall -D_REENTRANT -D__BLACKFIN__"
 
 if test x$debug = xtrue; then
    CFLAGS="$CFLAGS -O0 -DDEBUG"
